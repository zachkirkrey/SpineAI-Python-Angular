<div>
    <div class="row">
        <div class="col-12">
            <div id="page-header">
            </div>
            <div class="spinner-wrapper" *ngIf="isLoading">
                <div class="box-spinner">
                    <div></div>
                    <div></div>
                    <div></div>
                </div>
            </div>
            <div class="error" *ngIf="loadingPatientsError">
                <span>Error: {{ loadingPatientsError }}</span>
            </div>

            <div class="topbtno">
                <div class="addpatbtno">
                    <!--Appt Date DropDown-->
                    <div class="Appt-date-wrap d-flex align-items-center">
                        <label>Appt Date:</label>
                        <select class="appdate form-control" (change)='apptFilter($event)'>
                            <option *ngFor="let item of apptDateList; let i = index" [value]="item.value"
                                [selected]="item.name == 'All Time'">
                                {{item.name}}
                            </option>
                        </select>
                    </div>
                    <!--Appt Date DropDown-->
                </div>


                <div class="export-wrap">
                    <div class="checkbox-wrap">
                        <section class="example-section">
                            <mat-checkbox class="example-margin" (change)="showDoneItems($event)">
                                {{show_doneItems ? 'Hide Done items' : 'Show Done items'}}
                            </mat-checkbox>
                        </section>

                        <section class="example-section">
                            <mat-checkbox class="example-margin" (change)="showArchived($event)">
                                {{show_Archived ? 'Hide Archived' : 'Show Archived'}}
                            </mat-checkbox>
                        </section>

                        <section class="example-section">
                            <mat-checkbox class="example-margin" (change)="showPatientName($event)">
                                {{patientNameShown ? 'Hide patient name' : 'Show patient name'}}
                            </mat-checkbox>
                        </section>
                    </div>
                    <div class="buttons-wrap">
                        <button class="export-btn" mat-button [matMenuTriggerFor]="menu">Exports</button>
                        <mat-menu class="export-btn-list custom-export-btn" #menu="matMenu">
                            <button mat-menu-item>
                                <a href="{{ api_url }}/reports?as=summarycsv&type=JSON&sort=-creation_datetime&count=1000"
                                    target="_top" class="custom-button">
                                    <span>Area </span>
                                </a>
                            </button>
                            <button mat-menu-item>
                                <a href="{{ api_url }}/reports?as=summarycsv&type=JSON&sort=-creation_datetime&csvcol=canal_heights&count=1000"
                                    target="_top" class="custom-button">
                                    <span>Vertical Diameter </span>
                                </a>
                            </button>
                            <button mat-menu-item>
                                <a href="{{ api_url }}/reports?as=summarycsv&type=JSON&sort=-creation_datetime&csvcol=canal_widths&count=1000"
                                    target="_top" class="custom-button">
                                    <span>Horizontal Diameter </span>
                                </a>
                            </button>
                        </mat-menu>
                    </div>
                </div>
            </div>

            <div class="table-responsive">
                <table id="patients_table" class="table table-striped table-bordered table-responsive-sec" data-ordering="false">
                    <thead>
                        <tr>
                            <th (click)="sortOrder('mrn')" [style.display]="table-cell">MRN #</th>
                            <th (click)="sortOrder('patient_name')" *ngIf="patientNameShown"
                                [style.display]="table-cell">PATIENT NAME</th>
                            <th (click)="sortOrder('prev_action')" [style.display]="table-cell">PREV ACTION</th>
                            <th (click)="sortOrder('last_action')" [style.display]="table-cell">LAST ACTION</th>
                            <th (click)="sortOrder('last_action_date')" [style.display]="table-cell">LAST ACTION DATE</th>
                            <th (click)="sortOrder('appt_date')" [style.display]="table-cell">APPT DATE</th>
                            <th (click)="sortOrder('to_do')" [style.display]="table-cell">TO DO</th>
                        </tr>
                    </thead>
                    <tbody>
                        <tr #patients_rows *ngFor="let patient of patients; let i=index" [attr.data-index]="i">
                            <td [style.display]="table-cell">{{patient.mrn}}</td>
                            <td *ngIf="patientNameShown" [style.display]="table-cell">{{patient.name}}</td>
                            <td [style.display]="table-cell">{{patient.prev_action}}</td>
                            <td [style.display]="table-cell">{{patient.last_action}}</td>
                            <td [style.display]="table-cell">{{patient.last_action_date}}</td>
                            <td [style.display]="table-cell">{{patient.appt_date}}</td>
                            <td [style.display]="table-cell">
                                <button type="button" class="btn btn-link" (click)="openUpdateApptDialog(updateAppt)">
                                    UPDATE APPT
                                </button>
                            </td>
                        </tr>
                    </tbody>
                </table>
            </div> <!-- /table-responsive -->
        </div>
    </div>
</div>

<ng-template #updateAppt let-modal>
    <div class="modal-header">
        <h4 class="modal-title">History</h4>
        <button type="button" class="close" aria-label="Close" (click)="dismissDialog()">
          <span aria-hidden="true">&times;</span>
        </button>
      </div>
      <div class="modal-body">

        <!-- <ul *ngIf="actions.length" class="list-actions">
          <li *ngFor="let action of actions">
            {{ action.creation_datetime | date:'shortDate' }} {{ action.name }}
          </li>
        </ul> -->

        <form>
            <div class="row">
                <div class="col-md-6">
                    <p class="bolder-text color-black margin-0">Last Action:</p>
                    <select class="form-control mtop-5" name="last_action">
                        <option value=""></option>
                    </select>
                </div>
                <div class="col-md-6">
                    <p class="bolder-text color-black margin-0">Assignees:</p>
                    <select class="form-control mtop-5" name="assignees">
                        <option value=""></option>
                    </select>
                </div>
            </div>
            <div class="row mtop-15">
                <div class="col-md-6">
                    <p class="bolder-text color-black margin-0">Appointment Date:</p>
                    <div class="mtop-5"></div>
                    <mat-form-field class="" fxFlex>
                        <input matInput [matDatepicker]="appt_picker" class="form-control" appearance="outlined"
                            autocomplete="off" name="appt_picker"
                            [ngModelOptions]="{standalone: true}">
                        <mat-datepicker-toggle matSuffix [for]="appt_picker"></mat-datepicker-toggle>
                        <mat-datepicker  #appt_picker></mat-datepicker>
                    </mat-form-field>
                </div>
                <div class="col-md-6">
                    <p class="bolder-text color-black margin-0">Status:</p>
                    <select class="form-control mtop-5" name="status">
                        <option value=""></option>
                    </select>
                </div>
            </div>
            <div class="mtop-20">
                <button type="submit" class="custom-button outlined">Save</button>
            </div>
        </form>
      </div>
</ng-template>